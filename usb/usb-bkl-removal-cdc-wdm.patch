From oliver@neukum.org  Fri Jan 15 15:06:08 2010
From: Oliver Neukum <oliver@neukum.org>
Date: Thu, 14 Jan 2010 16:09:26 +0100
Subject: USB: BKL removal: cdc-wdm
Message-ID: <201001141609.26885.oliver@neukum.org>

From: Oliver Neukum <oliver@neukum.org>

BKL not needed at all. Removed without replacement.

Signed-off-by: Oliver Neukum <oliver@neukum.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

---
 drivers/usb/class/cdc-wdm.c |    3 ---
 1 file changed, 3 deletions(-)

--- a/drivers/usb/class/cdc-wdm.c
+++ b/drivers/usb/class/cdc-wdm.c
@@ -19,7 +19,6 @@
 #include <linux/uaccess.h>
 #include <linux/bitops.h>
 #include <linux/poll.h>
-#include <linux/smp_lock.h>
 #include <linux/usb.h>
 #include <linux/usb/cdc.h>
 #include <asm/byteorder.h>
@@ -517,7 +516,6 @@ static int wdm_open(struct inode *inode,
 	struct usb_interface *intf;
 	struct wdm_device *desc;
 
-	lock_kernel();
 	mutex_lock(&wdm_mutex);
 	intf = usb_find_interface(&wdm_driver, minor);
 	if (!intf)
@@ -550,7 +548,6 @@ static int wdm_open(struct inode *inode,
 	usb_autopm_put_interface(desc->intf);
 out:
 	mutex_unlock(&wdm_mutex);
-	unlock_kernel();
 	return rv;
 }
 
