From oliver@neukum.org  Fri Jan 15 15:07:43 2010
From: Oliver Neukum <oliver@neukum.org>
Date: Thu, 14 Jan 2010 16:12:01 +0100
Subject: USB: BKL removal: ftdi-elan
Message-ID: <201001141612.01300.oliver@neukum.org>


From: Oliver Neukum <oliver@neukum.org>

BKL was not needed at all. Removed without replacement.

Signed-off-by: Oliver Neukum <oliver@neukum.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

---
 drivers/usb/misc/ftdi-elan.c |    6 ------
 1 file changed, 6 deletions(-)

--- a/drivers/usb/misc/ftdi-elan.c
+++ b/drivers/usb/misc/ftdi-elan.c
@@ -45,7 +45,6 @@
 #include <linux/module.h>
 #include <linux/kref.h>
 #include <linux/mutex.h>
-#include <linux/smp_lock.h>
 #include <asm/uaccess.h>
 #include <linux/usb.h>
 #include <linux/workqueue.h>
@@ -627,27 +626,22 @@ static int ftdi_elan_open(struct inode *
 	int subminor;
 	struct usb_interface *interface;
 
-	lock_kernel();
         subminor = iminor(inode);
         interface = usb_find_interface(&ftdi_elan_driver, subminor);
 
         if (!interface) {
-		unlock_kernel();
                 printk(KERN_ERR "can't find device for minor %d\n", subminor);
                 return -ENODEV;
         } else {
                 struct usb_ftdi *ftdi = usb_get_intfdata(interface);
                 if (!ftdi) {
-			unlock_kernel();
                         return -ENODEV;
                 } else {
                         if (down_interruptible(&ftdi->sw_lock)) {
-				unlock_kernel();
                                 return -EINTR;
                         } else {
                                 ftdi_elan_get_kref(ftdi);
                                 file->private_data = ftdi;
-				unlock_kernel();
                                 return 0;
                         }
                 }
