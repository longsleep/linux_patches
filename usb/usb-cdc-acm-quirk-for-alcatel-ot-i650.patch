From kir@openvz.org  Tue Jun  2 14:44:57 2009
From: Kir Kolyshkin <kir@openvz.org>
Date: Thu, 28 May 2009 20:33:58 +0400
Subject: USB: cdc-acm: quirk for Alcatel OT-I650
Cc: Kir Kolyshkin <kir@openvz.org>
Message-ID: <1243528438-23040-1-git-send-email-kir@openvz.org>


This mobile phone fails to work as a modem, failing with:
 cdc_acm: Zero length descriptor references
 cdc_acm: probe of 1-6.1.3:1.1 failed with error -22

Tested to work fine with this patch.

Signed-off-by: Kir Kolyshkin <kir@openvz.org>
Cc: stable <stable@kernel.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

---
 drivers/usb/class/cdc-acm.c |    3 +++
 1 file changed, 3 insertions(+)

--- a/drivers/usb/class/cdc-acm.c
+++ b/drivers/usb/class/cdc-acm.c
@@ -1432,6 +1432,9 @@ static struct usb_device_id acm_ids[] = 
 					   Maybe we should define a new
 					   quirk for this. */
 	},
+	{ USB_DEVICE(0x1bbb, 0x0003), /* Alcatel OT-I650 */
+	.driver_info = NO_UNION_NORMAL, /* reports zero length descriptor */
+	},
 
 	/* control interfaces with various AT-command sets */
 	{ USB_INTERFACE_INFO(USB_CLASS_COMM, USB_CDC_SUBCLASS_ACM,
