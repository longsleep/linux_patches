From davem@davemloft.net  Thu Apr 29 13:05:42 2010
From: David Miller <davem@davemloft.net>
Date: Tue, 06 Apr 2010 18:26:03 -0700 (PDT)
Subject: USB: ehci: Elide I/O watchdog on NEC parts
To: linux-usb@vger.kernel.org
Cc: dbrownell@users.sourceforge.net
Message-ID: <20100406.182603.267636346.davem@davemloft.net>



I've been running with this patch on my Niagara2 boxes for some time
and have not seen any ill effects yet.  Maybe we can stash this into
the USB tree to get exposure for some time in -next and if anything
crops up we can simply revert?

Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

---
 drivers/usb/host/ehci-pci.c |    3 +++
 1 file changed, 3 insertions(+)

--- a/drivers/usb/host/ehci-pci.c
+++ b/drivers/usb/host/ehci-pci.c
@@ -109,6 +109,9 @@ static int ehci_pci_setup(struct usb_hcd
 		return retval;
 
 	switch (pdev->vendor) {
+	case PCI_VENDOR_ID_NEC:
+		ehci->need_io_watchdog = 0;
+		break;
 	case PCI_VENDOR_ID_INTEL:
 		ehci->need_io_watchdog = 0;
 		if (pdev->device == 0x27cc) {
