From akpm@linux-foundation.org Mon Feb  4 23:49:57 2008
From: Andrew Morton <akpm@linux-foundation.org>
Date: Mon, 04 Feb 2008 23:50:12 -0800
Subject: PCI: fix up setup-bus.c #ifdef
To: greg@kroah.com
Cc: akpm@linux-foundation.org, benh@kernel.crashing.org
Message-ID: <200802050749.m157nr3o010504@imap1.linux-foundation.org>


From: Andrew Morton <akpm@linux-foundation.org>

Use upper_32_bits(): no code changes, one less ifdef.

Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

---
 drivers/pci/setup-bus.c |    6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

--- a/drivers/pci/setup-bus.c
+++ b/drivers/pci/setup-bus.c
@@ -206,10 +206,8 @@ pci_setup_bridge(struct pci_bus *bus)
 	if (bus->resource[2]->flags & IORESOURCE_PREFETCH) {
 		l = (region.start >> 16) & 0xfff0;
 		l |= region.end & 0xfff00000;
-#ifdef CONFIG_RESOURCES_64BIT
-		bu = region.start >> 32;
-		lu = region.end >> 32;
-#endif
+		bu = upper_32_bits(region.start);
+		lu = upper_32_bits(region.end);
 		DBG(KERN_INFO "  PREFETCH window: 0x%016llx-0x%016llx\n",
 		    (unsigned long long)region.start,
 		    (unsigned long long)region.end);
