From 21cnbao@gmail.com  Tue Jun  1 13:42:25 2010
From: Barry Song <21cnbao@gmail.com>
Date: Tue, 25 May 2010 17:40:04 +0800
Subject: Staging: iio-utils: fix memory overflow for dynamically allocateded memory to hold filename
To: jic23@cam.ac.uk, gregkh@suse.de
Cc: linux-iio@vger.kernel.org, Barry Song <21cnbao@gmail.com>
Message-ID: <1274780404-17963-1-git-send-email-21cnbao@gmail.com>


Signed-off-by: Barry Song <21cnbao@gmail.com>
Acked-by: Jonathan Cameron <jic23@cam.ac.uk>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

---
 drivers/staging/iio/Documentation/iio_utils.h |    3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

--- a/drivers/staging/iio/Documentation/iio_utils.h
+++ b/drivers/staging/iio/Documentation/iio_utils.h
@@ -62,9 +62,8 @@ inline int find_type_by_name(const char
 					1) != 0) {
 				filename = malloc(strlen(iio_dir)
 						+ strlen(type)
-						+ 1
 						+ numstrlen
-						+ 1);
+						+ 6);
 				if (filename == NULL)
 					return -ENOMEM;
 				sprintf(filename, "%s%s%d/name",
