---
 drivers/usb/gadget/Makefile  |    4 ++--
 drivers/usb/gadget/cdc2.c    |    6 +++++-
 drivers/usb/gadget/ether.c   |    2 +-
 drivers/usb/gadget/u_ether.c |   14 +++++++-------
 4 files changed, 15 insertions(+), 11 deletions(-)

--- a/drivers/usb/gadget/cdc2.c
+++ b/drivers/usb/gadget/cdc2.c
@@ -19,11 +19,15 @@
  * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
  */
 
+#include "u_ether.c"
+#include "f_ecm.c"
+#undef DRIVER_VERSION
+
 #include <linux/kernel.h>
 #include <linux/utsname.h>
 
-#include "u_ether.h"
 #include "u_serial.h"
+#include "u_ether.h"
 
 
 #define DRIVER_DESC		"CDC Composite Gadget"
--- a/drivers/usb/gadget/ether.c
+++ b/drivers/usb/gadget/ether.c
@@ -25,7 +25,7 @@
 #include <linux/kernel.h>
 #include <linux/utsname.h>
 
-#include "u_ether.h"
+#include "u_ether.c"
 
 
 /*
--- a/drivers/usb/gadget/Makefile
+++ b/drivers/usb/gadget/Makefile
@@ -25,7 +25,7 @@ obj-$(CONFIG_USB_M66592)	+= m66592-udc.o
 C_UTILS =	composite.o usbstring.o config.o epautoconf.o
 
 g_zero-objs			:= zero.o f_sourcesink.o f_loopback.o $(C_UTILS)
-g_ether-objs			:= ether.o u_ether.o f_subset.o f_ecm.o $(C_UTILS)
+g_ether-objs			:= ether.o f_subset.o f_ecm.o $(C_UTILS)
 g_serial-objs			:= serial.o u_serial.o f_acm.o f_serial.o $(C_UTILS)
 g_midi-objs			:= gmidi.o usbstring.o config.o epautoconf.o
 gadgetfs-objs			:= inode.o
@@ -33,7 +33,7 @@ g_file_storage-objs		:= file_storage.o u
 					epautoconf.o
 g_printer-objs			:= printer.o usbstring.o config.o \
 					epautoconf.o
-g_cdc-objs			:= cdc2.o u_ether.o f_ecm.o \
+g_cdc-objs			:= cdc2.o f_ecm.o \
 					u_serial.o f_acm.o $(C_UTILS)
 
 ifeq ($(CONFIG_USB_ETH_RNDIS),y)
--- a/drivers/usb/gadget/u_ether.c
+++ b/drivers/usb/gadget/u_ether.c
@@ -115,8 +115,8 @@ static inline int qlen(struct usb_gadget
 
 #undef DBG
 #undef VDBG
-#undef ERROR
-#undef INFO
+#undef ether_ERROR
+#undef ether_INFO
 
 #define xprintk(d, level, fmt, args...) \
 	printk(level "%s: " fmt , (d)->net->name , ## args)
@@ -137,9 +137,9 @@ static inline int qlen(struct usb_gadget
 	do { } while (0)
 #endif /* DEBUG */
 
-#define ERROR(dev, fmt, args...) \
+#define ether_ERROR(dev, fmt, args...) \
 	xprintk(dev , KERN_ERR , fmt , ## args)
-#define INFO(dev, fmt, args...) \
+#define ether_INFO(dev, fmt, args...) \
 	xprintk(dev , KERN_INFO , fmt , ## args)
 
 /*-------------------------------------------------------------------------*/
@@ -197,7 +197,7 @@ static void defer_kevent(struct eth_dev 
 	if (test_and_set_bit(flag, &dev->todo))
 		return;
 	if (!schedule_work(&dev->work))
-		ERROR(dev, "kevent %d may have been dropped\n", flag);
+		ether_ERROR(dev, "kevent %d may have been dropped\n", flag);
 	else
 		DBG(dev, "kevent %d scheduled\n", flag);
 }
@@ -789,8 +789,8 @@ int __init gether_setup(struct usb_gadge
 	} else {
 		DECLARE_MAC_BUF(tmp);
 
-		INFO(dev, "MAC %s\n", print_mac(tmp, net->dev_addr));
-		INFO(dev, "HOST MAC %s\n", print_mac(tmp, dev->host_mac));
+		ether_INFO(dev, "MAC %s\n", print_mac(tmp, net->dev_addr));
+		ether_INFO(dev, "HOST MAC %s\n", print_mac(tmp, dev->host_mac));
 
 		the_dev = dev;
 	}
