From Dinh.Nguyen@freescale.com  Wed Apr 14 11:31:18 2010
From: Dinh.Nguyen@freescale.com
Date: Tue, 13 Apr 2010 11:13:15 -0500
Subject: usb: Increase timeout value for device reset
To: linux-usb@vger.kernel.org
Cc: dbrownell@users.sourceforge.net, amit.kucheria@canonical.com, Dinh Nguyen <Dinh.Nguyen@freescale.com>
Message-ID: <1271175195-3664-1-git-send-email-Dinh.Nguyen@freescale.com>


From: Dinh Nguyen <Dinh.Nguyen@freescale.com>

It seems that for USB IP on Freescale MX5x processors, it needs >750
usec for the reset to complete. This change should not hurt any other
EHCI hardware.

Signed-off-by: Dinh Nguyen <Dinh.Nguyen@freescale.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

---
 drivers/usb/host/ehci-hub.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/drivers/usb/host/ehci-hub.c
+++ b/drivers/usb/host/ehci-hub.c
@@ -801,7 +801,7 @@ static int ehci_hub_control (
 			 * this bit; seems too long to spin routinely...
 			 */
 			retval = handshake(ehci, status_reg,
-					PORT_RESET, 0, 750);
+					PORT_RESET, 0, 1000);
 			if (retval != 0) {
 				ehci_err (ehci, "port %d reset error %d\n",
 					wIndex + 1, retval);
