From wfp5p@virginia.edu  Wed Jul 29 14:33:02 2009
From: Bill Pemberton <wfp5p@virginia.edu>
Date: Wed, 29 Jul 2009 17:00:13 -0400
Subject: Staging: hv: remove wrapper function VirtualFree
To: greg@kroah.com
Cc: hjanssen@microsoft.com
Message-ID: <1248901215-29685-6-git-send-email-wfp5p@virginia.edu>


Signed-off-by: Bill Pemberton <wfp5p@virginia.edu>
Cc: Hank Janssen <hjanssen@microsoft.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

---
 drivers/staging/hv/Hv.c          |    6 +++---
 drivers/staging/hv/include/osd.h |    1 -
 drivers/staging/hv/osd.c         |    5 -----
 3 files changed, 3 insertions(+), 9 deletions(-)

--- a/drivers/staging/hv/Hv.c
+++ b/drivers/staging/hv/Hv.c
@@ -21,7 +21,7 @@
  *
  */
 
-
+#include <linux/vmalloc.h>
 #include "include/logging.h"
 #include "VmbusPrivate.h"
 
@@ -330,7 +330,7 @@ Cleanup:
 			WriteMsr(HV_X64_MSR_HYPERCALL, hypercallMsr.AsUINT64);
 		}
 
-		VirtualFree(virtAddr);
+		vfree(virtAddr);
 	}
 	ret = -1;
 	DPRINT_EXIT(VMBUS);
@@ -370,7 +370,7 @@ HvCleanup (
 		{
 			hypercallMsr.AsUINT64 = 0;
 			WriteMsr(HV_X64_MSR_HYPERCALL, hypercallMsr.AsUINT64);
-			VirtualFree(gHvContext.HypercallPage);
+			vfree(gHvContext.HypercallPage);
 			gHvContext.HypercallPage = NULL;
 		}
 	}
--- a/drivers/staging/hv/include/osd.h
+++ b/drivers/staging/hv/include/osd.h
@@ -110,7 +110,6 @@ static inline void do_cpuid(unsigned int
 /* Osd routines */
 
 extern void* VirtualAllocExec(unsigned int size);
-extern void VirtualFree(void* VirtAddr);
 
 extern void* PageAlloc(unsigned int count);
 extern void PageFree(void* page, unsigned int count);
--- a/drivers/staging/hv/osd.c
+++ b/drivers/staging/hv/osd.c
@@ -65,11 +65,6 @@ void* VirtualAllocExec(unsigned int size
 #endif
 }
 
-void VirtualFree(void* VirtAddr)
-{
-	return vfree(VirtAddr);
-}
-
 void* PageAlloc(unsigned int count)
 {
 	void *p;
