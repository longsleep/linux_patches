From bzolnier@gmail.com  Fri Jul 10 15:59:19 2009
From: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>
Date: Fri, 03 Jul 2009 16:06:27 +0200
Subject: Staging: rtl8192su: remove USE_ONE_PIPE ifdefs
To: "Greg Kroah-Hartman" <gregkh@suse.de>
Cc: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>, linux-kernel@vger.kernel.org
Message-ID: <20090703140627.7303.87368.sendpatchset@localhost.localdomain>


From: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>

Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
---
 drivers/staging/rtl8192su/Makefile      |    1 -
 drivers/staging/rtl8192su/r8192U.h      |   13 -------------
 drivers/staging/rtl8192su/r8192U_core.c |   15 ---------------
 3 files changed, 29 deletions(-)

--- a/drivers/staging/rtl8192su/Makefile
+++ b/drivers/staging/rtl8192su/Makefile
@@ -6,7 +6,6 @@ EXTRA_CFLAGS += -mhard-float -DCONFIG_FO
 
 EXTRA_CFLAGS += -DJACKSON_NEW_RX
 EXTRA_CFLAGS += -DTHOMAS_BEACON
-#EXTRA_CFLAGS += -DUSE_ONE_PIPE
 
 EXTRA_CFLAGS += -DRTL8192SU
 EXTRA_CFLAGS += -DRTL8190_Download_Firmware_From_Header=1
--- a/drivers/staging/rtl8192su/r8192U_core.c
+++ b/drivers/staging/rtl8192su/r8192U_core.c
@@ -2985,11 +2985,7 @@ short rtl819xU_tx_cmd(struct net_device 
 	// Fill up USB_OUT_CONTEXT.
 	//----------------------------------------------------------------------------
 	// Get index to out pipe from specified QueueID.
-#ifndef USE_ONE_PIPE
 	idx_pipe = txqueue2outpipe(priv,queue_index);
-#else
-	idx_pipe = 0x04;
-#endif
 #ifdef JOHN_DUMP_TXDESC
 	int i;
 	printk("<Tx descriptor>--rate %x---",rate);
@@ -3786,11 +3782,7 @@ short rtl8192_tx(struct net_device *dev,
 		tx_desc->TxBufferSize = (u32)(skb->len - USB_HWDESC_HEADER_LEN);
 	}
 	/* Get index to out pipe from specified QueueID */
-#ifndef USE_ONE_PIPE
 	idx_pipe = txqueue2outpipe(priv,tcb_desc->queue_index);
-#else
-	idx_pipe = 0x5;
-#endif
 
 	//RT_DEBUG_DATA(COMP_SEND,tx_fwinfo,sizeof(tx_fwinfo_819x_usb));
 	//RT_DEBUG_DATA(COMP_SEND,tx_desc,sizeof(tx_desc_819x_usb));
@@ -11721,7 +11713,6 @@ static void HalUsbSetQueuePipeMapping819
 	memset(priv->RtOutPipes,0,16);
 	memset(priv->RtInPipes,0,16);
 
-#ifndef USE_ONE_PIPE
 	iface_desc = intf->cur_altsetting;
 	priv->ep_num = iface_desc->desc.bNumEndpoints;
 
@@ -11776,12 +11767,6 @@ static void HalUsbSetQueuePipeMapping819
 	for(i=0; i < 9; i++)
 		printk("%d  ", priv->txqueue_to_outpipemap[i]);
 	printk("\n");
-#else
-	{
-		memset(priv->txqueue_to_outpipemap,0,9);
-		memset(priv->RtOutPipes,4,16);//all use endpoint 4 for out
-	}
-#endif
 
 	return;
 }
--- a/drivers/staging/rtl8192su/r8192U.h
+++ b/drivers/staging/rtl8192su/r8192U.h
@@ -1085,18 +1085,6 @@ typedef struct _rt_firmware_info_819xUsb
 #define NUM_OF_FIRMWARE_QUEUE		10
 #define NUM_OF_PAGES_IN_FW		0x100
 
-#ifdef USE_ONE_PIPE
-#define NUM_OF_PAGE_IN_FW_QUEUE_BE	0x000
-#define NUM_OF_PAGE_IN_FW_QUEUE_BK	0x000
-#define NUM_OF_PAGE_IN_FW_QUEUE_VI	0x0ff
-#define NUM_OF_PAGE_IN_FW_QUEUE_VO	0x000
-#define NUM_OF_PAGE_IN_FW_QUEUE_HCCA	0
-#define NUM_OF_PAGE_IN_FW_QUEUE_CMD	0x0
-#define NUM_OF_PAGE_IN_FW_QUEUE_MGNT	0x00
-#define NUM_OF_PAGE_IN_FW_QUEUE_HIGH	0
-#define NUM_OF_PAGE_IN_FW_QUEUE_BCN	0x0
-#define NUM_OF_PAGE_IN_FW_QUEUE_PUB	0x00
-#else
 
 #define NUM_OF_PAGE_IN_FW_QUEUE_BE	0x020
 #define NUM_OF_PAGE_IN_FW_QUEUE_BK	0x020
@@ -1109,7 +1097,6 @@ typedef struct _rt_firmware_info_819xUsb
 #define NUM_OF_PAGE_IN_FW_QUEUE_BCN	0x4
 #define NUM_OF_PAGE_IN_FW_QUEUE_PUB	0x18
 
-#endif
 
 #define APPLIED_RESERVED_QUEUE_IN_FW	0x80000000
 #define RSVD_FW_QUEUE_PAGE_BK_SHIFT	0x00
