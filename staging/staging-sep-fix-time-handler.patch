From alan@lxorguk.ukuu.org.uk  Wed Aug 12 13:20:54 2009
From: Alan Cox <alan@lxorguk.ukuu.org.uk>
Date: Fri, 07 Aug 2009 19:24:00 +0100
Subject: Staging: sep: fix time handler
To: greg@kroah.com, mark.a.allyn@intel.com
Message-ID: <20090807182356.19360.15627.stgit@localhost.localdomain>


From: Alan Cox <alan@linux.intel.com>

Cleaning up the code reveals an obvious thinko

Signed-off-by: Alan Cox <alan@linux.intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
---

 drivers/staging/sep/sep_driver.c |    4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)


--- a/drivers/staging/sep/sep_driver.c
+++ b/drivers/staging/sep/sep_driver.c
@@ -2143,7 +2143,9 @@ static int sep_get_time_handler(unsigned
 	struct sep_driver_get_time_t command_args;
 
 	error = sep_set_time(&command_args.time_physical_address, &command_args.time_value);
-	error = copy_to_user((void *) arg, (void *) &command_args, sizeof(struct sep_driver_get_time_t));
+	if (error == 0)
+		error = copy_to_user((void __user *)arg,
+			&command_args, sizeof(struct sep_driver_get_time_t));
 	return error;
 
 }
