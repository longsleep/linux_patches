From dcb314@hotmail.com  Wed Jan 27 18:30:27 2010
From: d binderman <dcb314@hotmail.com>
Date: Tue, 26 Jan 2010 10:00:25 +0000
Subject: Staging: otus: fix memory leak
To: <gregkh@suse.de>
Message-ID: <BLU108-W17B331BF278377532631D79C5E0@phx.gbl>


Fix memory leak in drivers/staging/otus

Signed-off-by: David Binderman <dcb314@hotmail.com>

---
 drivers/staging/otus/ioctl.c |    6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

--- a/drivers/staging/otus/ioctl.c
+++ b/drivers/staging/otus/ioctl.c
@@ -866,15 +866,15 @@ int usbdrvwext_giwscan(struct net_device
 	char *current_ev = extra;
 	char *end_buf;
 	int i;
-	/* struct zsBssList BssList; */
-	struct zsBssListV1 *pBssList = kmalloc(sizeof(struct zsBssListV1),
-								GFP_KERNEL);
 	/* BssList = wd->sta.pBssList; */
 	/* zmw_get_wlan_dev(dev); */
 
 	if (macp->DeviceOpened != 1)
 		return 0;
 
+	/* struct zsBssList BssList; */
+	struct zsBssListV1 *pBssList = kmalloc(sizeof(struct zsBssListV1),
+								GFP_KERNEL);
 	if (data->length == 0)
 		end_buf = extra + IW_SCAN_MAX_DATA;
 	else
