From wfp5p@virginia.edu Mon Mar 16 17:21:18 2009
From: Bill Pemberton <wfp5p@virginia.edu>
Date: Mon, 16 Mar 2009 22:06:31 -0400
Subject: Staging: comedi: Remove comedi_krange typedef
To: greg@kroah.com
Message-ID: <20090317020631.14467.19021.stgit@viridian.itc.Virginia.EDU>


Signed-off-by: Bill Pemberton <wfp5p@virginia.edu>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
---

 drivers/staging/comedi/comedi.h                |    3 +--
 drivers/staging/comedi/comedidev.h             |    2 +-
 drivers/staging/comedi/comedilib.h             |    4 ++--
 drivers/staging/comedi/drivers/cb_pcidas64.c   |    2 +-
 drivers/staging/comedi/drivers/comedi_test.c   |    4 ++--
 drivers/staging/comedi/drivers/das16.c         |    6 +++---
 drivers/staging/comedi/drivers/jr3_pci.c       |    2 +-
 drivers/staging/comedi/drivers/ni_mio_common.c |    2 +-
 drivers/staging/comedi/drivers/serial2002.c    |    2 +-
 drivers/staging/comedi/kcomedilib/get.c        |    4 ++--
 drivers/staging/comedi/range.c                 |    4 ++--
 11 files changed, 17 insertions(+), 18 deletions(-)

--- a/drivers/staging/comedi/comedidev.h
+++ b/drivers/staging/comedi/comedidev.h
@@ -409,7 +409,7 @@ extern const struct comedi_lrange range_
 
 struct comedi_lrange {
 	int length;
-	comedi_krange range[GCC_ZERO_LENGTH_ARRAY];
+	struct comedi_krange range[GCC_ZERO_LENGTH_ARRAY];
 };
 
 /* some silly little inline functions */
--- a/drivers/staging/comedi/comedi.h
+++ b/drivers/staging/comedi/comedi.h
@@ -310,7 +310,6 @@ enum comedi_support_level {
 
 /* structures */
 
-typedef struct comedi_krange_struct comedi_krange;
 typedef struct comedi_bufconfig_struct comedi_bufconfig;
 typedef struct comedi_bufinfo_struct comedi_bufinfo;
 
@@ -382,7 +381,7 @@ struct comedi_rangeinfo {
 	void *range_ptr;
 };
 
-struct comedi_krange_struct {
+struct comedi_krange {
 	int min;	/* fixed point, multiply by 1e-6 */
 	int max;	/* fixed point, multiply by 1e-6 */
 	unsigned int flags;
--- a/drivers/staging/comedi/comedilib.h
+++ b/drivers/staging/comedi/comedilib.h
@@ -103,7 +103,7 @@ int comedi_get_rangetype(void *dev, unsi
 unsigned int comedi_get_subdevice_flags(void *dev, unsigned int subdevice);
 int comedi_get_len_chanlist(void *dev, unsigned int subdevice);
 int comedi_get_krange(void *dev, unsigned int subdevice, unsigned int
-	chan, unsigned int range, comedi_krange *krange);
+	chan, unsigned int range, struct comedi_krange *krange);
 unsigned int comedi_get_buf_head_pos(void *dev, unsigned int subdevice);
 int comedi_set_user_int_count(void *dev, unsigned int subdevice,
 	unsigned int buf_user_count);
@@ -177,7 +177,7 @@ unsigned int comedi_get_subdevice_flags(
 	subdevice);
 int comedi_get_len_chanlist(unsigned int minor, unsigned int subdevice);
 int comedi_get_krange(unsigned int minor, unsigned int subdevice, unsigned int
-	chan, unsigned int range, comedi_krange *krange);
+	chan, unsigned int range, struct comedi_krange *krange);
 unsigned int comedi_get_buf_head_pos(unsigned int minor, unsigned int
 	subdevice);
 int comedi_set_user_int_count(unsigned int minor, unsigned int subdevice,
--- a/drivers/staging/comedi/drivers/cb_pcidas64.c
+++ b/drivers/staging/comedi/drivers/cb_pcidas64.c
@@ -1203,7 +1203,7 @@ COMEDI_PCI_INITCLEANUP(driver_cb_pcidas,
 static unsigned int ai_range_bits_6xxx(const struct comedi_device * dev,
 	unsigned int range_index)
 {
-	const comedi_krange *range =
+	const struct comedi_krange *range =
 		&board(dev)->ai_range_table->range[range_index];
 	unsigned int bits = 0;
 
--- a/drivers/staging/comedi/drivers/comedi_test.c
+++ b/drivers/staging/comedi/drivers/comedi_test.c
@@ -442,7 +442,7 @@ static short fake_sawtooth(struct comedi
 	struct comedi_subdevice *s = dev->read_subdev;
 	unsigned int offset = s->maxdata / 2;
 	u64 value;
-	const comedi_krange *krange = &s->range_table->range[range_index];
+	const struct comedi_krange *krange = &s->range_table->range[range_index];
 	u64 binary_amplitude;
 
 	binary_amplitude = s->maxdata;
@@ -463,7 +463,7 @@ static short fake_squarewave(struct come
 	struct comedi_subdevice *s = dev->read_subdev;
 	unsigned int offset = s->maxdata / 2;
 	u64 value;
-	const comedi_krange *krange = &s->range_table->range[range_index];
+	const struct comedi_krange *krange = &s->range_table->range[range_index];
 	current_time %= devpriv->usec_period;
 
 	value = s->maxdata;
--- a/drivers/staging/comedi/drivers/das16.c
+++ b/drivers/staging/comedi/drivers/das16.c
@@ -1375,7 +1375,7 @@ static int das16_attach(struct comedi_de
 	unsigned int dma_chan;
 	int timer_mode;
 	unsigned long flags;
-	comedi_krange *user_ai_range, *user_ao_range;
+	struct comedi_krange *user_ai_range, *user_ao_range;
 
 	iobase = it->options[0];
 #if 0
@@ -1496,7 +1496,7 @@ static int das16_attach(struct comedi_de
 		(it->options[4] || it->options[5])) {
 		// allocate single-range range table
 		devpriv->user_ai_range_table =
-			kmalloc(sizeof(struct comedi_lrange) + sizeof(comedi_krange),
+			kmalloc(sizeof(struct comedi_lrange) + sizeof(struct comedi_krange),
 			GFP_KERNEL);
 		// initialize ai range
 		devpriv->user_ai_range_table->length = 1;
@@ -1509,7 +1509,7 @@ static int das16_attach(struct comedi_de
 	if (it->options[6] || it->options[7]) {
 		// allocate single-range range table
 		devpriv->user_ao_range_table =
-			kmalloc(sizeof(struct comedi_lrange) + sizeof(comedi_krange),
+			kmalloc(sizeof(struct comedi_lrange) + sizeof(struct comedi_krange),
 			GFP_KERNEL);
 		// initialize ao range
 		devpriv->user_ao_range_table->length = 1;
--- a/drivers/staging/comedi/drivers/jr3_pci.c
+++ b/drivers/staging/comedi/drivers/jr3_pci.c
@@ -156,7 +156,7 @@ typedef struct {
 	int model_no;
 	struct {
 		int length;
-		comedi_krange range;
+		struct comedi_krange range;
 	} range[9];
 	const struct comedi_lrange *range_table_list[8 * 7 + 2];
 	unsigned int maxdata_list[8 * 7 + 2];
--- a/drivers/staging/comedi/drivers/ni_mio_common.c
+++ b/drivers/staging/comedi/drivers/ni_mio_common.c
@@ -2818,7 +2818,7 @@ static int ni_m_series_ao_config_chanlis
 		}
 	}
 	for (i = 0; i < n_chans; i++) {
-		const comedi_krange *krange;
+		const struct comedi_krange *krange;
 		chan = CR_CHAN(chanspec[i]);
 		range = CR_RANGE(chanspec[i]);
 		krange = s->range_table->range + range;
--- a/drivers/staging/comedi/drivers/serial2002.c
+++ b/drivers/staging/comedi/drivers/serial2002.c
@@ -63,7 +63,7 @@ static const serial2002_board serial2002
 typedef struct {
 	// HACK...
 	int length;
-	comedi_krange range;
+	struct comedi_krange range;
 } serial2002_range_table_t;
 
 typedef struct {
--- a/drivers/staging/comedi/kcomedilib/get.c
+++ b/drivers/staging/comedi/kcomedilib/get.c
@@ -149,7 +149,7 @@ int comedi_get_n_ranges(void *d, unsigne
  * ALPHA (non-portable)
 */
 int comedi_get_krange(void *d, unsigned int subdevice, unsigned int chan,
-	unsigned int range, comedi_krange *krange)
+	unsigned int range, struct comedi_krange *krange)
 {
 	struct comedi_device *dev = (struct comedi_device *) d;
 	struct comedi_subdevice *s = dev->subdevices + subdevice;
@@ -163,7 +163,7 @@ int comedi_get_krange(void *d, unsigned 
 	if (range >= lr->length)
 		return -EINVAL;
 
-	memcpy(krange, lr->range + range, sizeof(comedi_krange));
+	memcpy(krange, lr->range + range, sizeof(struct comedi_krange));
 
 	return 0;
 }
--- a/drivers/staging/comedi/range.c
+++ b/drivers/staging/comedi/range.c
@@ -42,7 +42,7 @@ const struct comedi_lrange range_unknown
 		range info structure
 
 	writes:
-		n comedi_krange structures to rangeinfo->range_ptr
+		n struct comedi_krange structures to rangeinfo->range_ptr
 */
 int do_rangeinfo_ioctl(struct comedi_device *dev, struct comedi_rangeinfo *arg)
 {
@@ -78,7 +78,7 @@ int do_rangeinfo_ioctl(struct comedi_dev
 	}
 
 	if (copy_to_user(it.range_ptr, lr->range,
-			sizeof(comedi_krange) * lr->length))
+			sizeof(struct comedi_krange) * lr->length))
 		return -EFAULT;
 
 	return 0;
