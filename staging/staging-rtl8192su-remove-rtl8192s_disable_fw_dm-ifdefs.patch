From bzolnier@gmail.com  Fri Jul 10 16:00:15 2009
From: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>
Date: Fri, 03 Jul 2009 16:07:00 +0200
Subject: Staging: rtl8192su: remove RTL8192S_DISABLE_FW_DM ifdefs
To: "Greg Kroah-Hartman" <gregkh@suse.de>
Cc: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>, linux-kernel@vger.kernel.org
Message-ID: <20090703140700.7303.66461.sendpatchset@localhost.localdomain>


From: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>

Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
---
 drivers/staging/rtl8192su/Makefile                         |    1 -
 drivers/staging/rtl8192su/ieee80211/ieee80211_softmac_wx.c |    4 ----
 drivers/staging/rtl8192su/r8192S_phy.c                     |    2 --
 drivers/staging/rtl8192su/r8192U_core.c                    |    3 ---
 4 files changed, 10 deletions(-)

--- a/drivers/staging/rtl8192su/ieee80211/ieee80211_softmac_wx.c
+++ b/drivers/staging/rtl8192su/ieee80211/ieee80211_softmac_wx.c
@@ -330,13 +330,11 @@ void ieee80211_wx_sync_scan_wq(struct wo
 #ifndef RTL8192SE
 	ieee->InitialGainHandler(ieee->dev,IG_Backup);
 #endif
-#if(RTL8192S_DISABLE_FW_DM == 0)
 	if (ieee->SetFwCmdHandler)
 	{
 		ieee->SetFwCmdHandler(ieee->dev, FW_CMD_DIG_HALT);
 		ieee->SetFwCmdHandler(ieee->dev, FW_CMD_HIGH_PWR_DISABLE);
 	}
-#endif
 	if (ieee->pHTInfo->bCurrentHTSupport && ieee->pHTInfo->bEnableHT && ieee->pHTInfo->bCurBW40MHz) {
 		b40M = 1;
 		chan_offset = ieee->pHTInfo->CurSTAExtChnlOffset;
@@ -361,13 +359,11 @@ void ieee80211_wx_sync_scan_wq(struct wo
 #ifndef RTL8192SE
 	ieee->InitialGainHandler(ieee->dev,IG_Restore);
 #endif
-#if(RTL8192S_DISABLE_FW_DM == 0)
 	if (ieee->SetFwCmdHandler)
 	{
 		ieee->SetFwCmdHandler(ieee->dev, FW_CMD_DIG_RESUME);
 		ieee->SetFwCmdHandler(ieee->dev, FW_CMD_HIGH_PWR_ENABLE);
 	}
-#endif
 	ieee->state = IEEE80211_LINKED;
 	ieee->link_change(ieee->dev);
 	// To prevent the immediately calling watch_dog after scan.
--- a/drivers/staging/rtl8192su/Makefile
+++ b/drivers/staging/rtl8192su/Makefile
@@ -12,7 +12,6 @@ EXTRA_CFLAGS += -DRTL8190_Download_Firmw
 EXTRA_CFLAGS += -DRTL8192S_PREPARE_FOR_NORMAL_RELEASE
 EXTRA_CFLAGS += -DRTL8192SU_DISABLE_IQK=1
 
-EXTRA_CFLAGS += -DRTL8192S_DISABLE_FW_DM=0
 EXTRA_CFLAGS += -DDISABLE_BB_RF=0
 EXTRA_CFLAGS += -DRTL8192SU_USE_PARAM_TXPWR=0
 EXTRA_CFLAGS += -DRTL8192SU_FPGA_UNSPECIFIED_NETWORK=0
--- a/drivers/staging/rtl8192su/r8192S_phy.c
+++ b/drivers/staging/rtl8192su/r8192S_phy.c
@@ -3074,7 +3074,6 @@ PHY_ScanOperationBackup8192S(
 
 
 
-#if(RTL8192S_DISABLE_FW_DM == 0)
 
 	if(!Adapter->bDriverStopped)
 	{
@@ -3103,7 +3102,6 @@ PHY_ScanOperationBackup8192S(
 				break;
 		}
 	}
-#endif
 }
 #endif
 
--- a/drivers/staging/rtl8192su/r8192U_core.c
+++ b/drivers/staging/rtl8192su/r8192U_core.c
@@ -7014,9 +7014,6 @@ start:
 	//
 	rtl8192SU_MacConfigAfterFwDownload(dev);
 
-#if (RTL8192S_DISABLE_FW_DM == 1)
-	write_nic_dword(dev, WFM5, FW_DM_DISABLE);
-#endif
 	//priv->bLbusEnable = TRUE;
 	//if(priv->RegRfOff == TRUE)
 	//	priv->eRFPowerState = eRfOff;
